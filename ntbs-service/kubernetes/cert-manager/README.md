# TLS Certificates

Our Azure environments (`int`, `test` and `uat`) use [cert-manager](https://cert-manager.io/) to provide their TLS certificates. The certificates generated by cert-manager (which uses [Let's Encrypt](https://letsencrypt.org/) under the hood) have a 90 day lifetime, but should auto-renew.

The files in this directory contain the `ClusterIssuer` and `Certificate` resources used in this process.

The steps taken to set this up were:
1. Install cert-manager version 1.2.0 in the kubernetes cluster.
2. Create the `ClusterIssuer` resources using the command `kubectl apply -f <env>-cluster-issuer.yaml`.
3. Create the `Certificate` resources using the command `kubectl apply -f <env>-certificate.yaml`.
4. Once a `Certificate` is created, cert-manager initiates the process of obtaining a certificate via Let's Encrypt. When the certificate is generated, it is stored in the kubernetes secret `phe-ntbs-<env>-tls` which is then picked up by the corresponding `ntbs-<env>` `Ingress`.
